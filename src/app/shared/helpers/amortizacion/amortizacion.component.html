<div class="card">
  <div class="card-header card-header-icon">
    <div class="card-icon cardHeader">
      <i class="material-icons">assessment</i>
    </div>
    <h4 class="card-title">Proforma
      <button mat-icon-button class="close" (click)="close()">
        <i class="material-icons">close</i> </button>
    </h4>
  </div>
  <br>
  <div class="card-body">
    <div class="row">
      <mat-form-field class="col-sm-4">
        <input matInput placeholder="Cliente:" [(ngModel)]="e.noSolicitante" readonly>
      </mat-form-field>
      <mat-form-field class="col-sm-4">
        <input matInput placeholder="Tipo Préstamo:" [(ngModel)]="tipoPres" readonly>
      </mat-form-field>
      <mat-form-field class="col-sm-4">
        <input matInput placeholder="Monto:" [(ngModel)]="monto" readonly>
      </mat-form-field>
      <mat-form-field class="col-sm-4">
        <input matInput placeholder="Interés:" [(ngModel)]="interes" readonly>
      </mat-form-field>
      <mat-form-field class="col-sm-4">
        <input matInput placeholder="Cuota:" [(ngModel)]="cuota" readonly>
      </mat-form-field>
      <mat-form-field class="col-sm-4">
        <input matInput placeholder="Fecha de Inicio:" [(ngModel)]="fechaInicio" readonly>
      </mat-form-field>
    </div>
  </div>
  <div class="card-body" >
    <div class="material-datatables table-responsive">
      <table id="dtResultado" class="table table-striped table-no-bordered table-hover" cellspacing="0" width="100%"
        style="width:100%">
        <thead class="cabeceraTable">
          <tr>
            <th class="text-center">N° Cuota</th>
            <th class="text-center">Fecha de Cuota</th>
            <th class="text-center">Cuota</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let element of listPagos; let i = index">
            <td class="text-center">{{i+1}} </td>
            <td class="text-center">{{element.fecha_cuota | date:'dd-MM-yyyy'}}</td>
            <td class="text-center" style="font-weight: bold;">{{element.cuota  | currency: 'S/'}}</td>
          </tr>
        </tbody>
      </table>
      <h5 class="col-auto"> <strong> Interés + Capital: </strong> {{total | currency: 'S/'}}</h5>
      <br>
      <div class="col-12 text-right">
        <button mat-raised-button="" (click)="imprimir()" type="button" class="btn btn-fill printing btn-sm btn-primary"
          matTooltip="Imprimir" [matTooltipPosition]="'above'">
          <i class="material-icons">print</i>
        </button>
      </div>
    </div>
  </div>
</div>
<div style="display:none">
  <div id="print-section-material" style="font-family: Arial, Helvetica, sans-serif;color: #000;font-size: 12px;">
    <div style="display:flex;">
      <table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tbody>
          <tr>
            <td width="30%">
              <div style="margin-bottom: 5px;padding-left: 20%;">
                <img style="height: 100px; width: 150px;"
                  src="{{logo ? logo : './assets/img/credismart/icono_credi.jpeg'}}">
              </div>
            </td>
            <td width="40%">
              <div
                style="text-align: center; font-family: Arial, Helvetica, 'sans-serif'; color: #212121;  font-size: 28px; line-height: 35px;">
                {{nombre}}<br>
                {{dir}}<br>
                Tlf: {{tel}}
              </div>
            </td>
            <td width="30%">
              <div
                style="text-align: center; font-family: Arial, Helvetica, 'sans-serif'; color: #212121; font-size: 20px; line-height: 20px;">
                <strong>Fecha:</strong> {{fecha_str}}<br>
                <strong>Hora: </strong>{{hora}} <br>
              </div>
            </td>
          </tr>
          <br>
        </tbody>
        <br>
      </table>
    </div>
    <div
      style="font-family: Arial, Helvetica, 'sans-serif'; color: #212121; font-size: 24px; padding: 15px; text-align: CENTER; line-height: 28px">
      <strong>PROFORMA</strong>
    </div>
    <div style="margin-top: 10px;">
      <table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tbody>
          <tr>
            <td width="35%">
              <div
                style="font-family: Arial, Helvetica, 'sans-serif'; color: #212121; font-size: 20px;  padding: 15px; text-align: center; line-height: 28px">
                <strong>Cliente: </strong>{{e.noSolicitante}}<br>
                <strong>Interés: </strong>{{interes}}<br>
              </div>
            </td>
            <td width="35%">
              <div
                style="font-family: Arial, Helvetica, 'sans-serif'; color: #212121; font-size: 20px;  padding: 15px; text-align: center; line-height: 28px">
                <strong>N° de Documento: </strong>{{e.nuDocideSolicitante}}<br>
                <strong>N° Cuotas: </strong>{{e.nuCuota}}<br>
              </div>
            </td>
            <td width="35%">
              <div
                style="font-family: Arial, Helvetica, 'sans-serif'; color: #212121; font-size: 20px;  padding: 15px; text-align: center; line-height: 28px">
                <strong>Monto: </strong>{{monto}}<br>
                <strong>Fecha Inicio: </strong>{{fechaInicio}}<br>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <div style="margin-top:20px;">
      <table width="100%" cellspacing="0" cellpadding="0">
        <thead style="background-color:#1d5ea0; color:white;text-transform: uppercase;">
          <tr>
            <th width="20%">
              <div
                style="font-family: Arial, Helvetica, 'sans-serif'; font-size: 18px;  padding: 12px; text-align: center; line-height: 28px;font-weight: bold">
                N° Cuota</div>
            </th>
            <th width="20%">
              <div
                style="font-family: Arial, Helvetica, 'sans-serif'; font-size: 18px;  padding: 12px; text-align: center; line-height: 28px;font-weight: bold">
                Fecha de cuota</div>
            </th>
            <th width="20%">
              <div
                style="font-family: Arial, Helvetica, 'sans-serif'; font-size: 18px;  padding: 12px; text-align: center; line-height: 28px;font-weight: bold">
                Cuota</div>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let row of listPagos">
            <td width="20%" align="center"
              style="border-bottom: solid 1px #ddd; padding: 20px; max-width: 300px; overflow-wrap: break-word;font-family: Arial, Helvetica, 'sans-serif'; color: #212121; font-size: 18px;  text-align: center;">
              {{row.idPago}}
            </td>
            <td width="20%" align="right" valign="top"
              style="border-bottom: solid 1px #ddd; padding: 20px; font-family: Arial, Helvetica, 'sans-serif'; color: #212121; font-size: 18px;  text-align: center; ">
              {{row.fecha_cuota| date:'dd-MM-yyyy'}}
            </td>
            <td width="20%" align="center" valign="top"
              style="border-bottom: solid 1px #ddd; padding: 20px; font-family: Arial, Helvetica, 'sans-serif'; color: red; font-size: 18px;  text-align: center;text-transform: uppercase">
              {{row.cuota| currency: 'S/'}}
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>